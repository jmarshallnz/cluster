
R : Copyright 2002, The R Development Core Team
Version 1.6.0 Under development (unstable) (2002-09-09)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> library(cluster)
Loading required package: mva 
> 
> eh <- ellipsoidhull(cbind(x=1:4, y = 1:4)) #singular
Error in Fortran routine computing the spanning ellipsoid,
 probably collinear data
Warning message: 
possibly not converged in 5000 iterations in: ellipsoidhull(cbind(x = 1:4, y = 1:4)) 
> eh
`ellipsoid' in 2 dimensions:
 center = ( 2.5 2.5 ); squared ave.radius d^2 =  0 
 and shape matrix =
   
       x    y
  x 1.25 1.25
  y 1.25 1.25
  hence, area  =  0 

** Warning: ** the algorithm did not terminate reliably!
   most probably because of collinear data 
> 
> set.seed(157)
> for(n in 4:10) { ## n=2 and 3 still differ -- platform dependently!
+     cat("n = ",n,"\n")
+     x2 <- rnorm(n)
+     try(print(ellipsoidhull(cbind(1:n, x2))))
+     try(print(ellipsoidhull(cbind(1:n, x2, 4*x2 + rnorm(n)))))
+ }
n =  4 
`ellipsoid' in 2 dimensions:
 center = (  2.667985 -0.043826 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                    x2
      1.55574 -0.89914
  x2 -0.89914  1.22116
  hence, area  =  6.5639 
`ellipsoid' in 3 dimensions:
 center = (  2.500000 -0.042653  0.470873 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                    x2        
      1.25000 -0.67561 -3.6570
  x2 -0.67561  0.91678  3.5211
     -3.65701  3.52109 15.8994
  hence, volume  =  7.3242 
n =  5 
`ellipsoid' in 2 dimensions:
 center = ( 3.0467 1.1306 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                  x2
     2.28171 0.91442
  x2 0.91442 1.32673
  hence, area  =  9.3005 
`ellipsoid' in 3 dimensions:
 center = ( 2.97060 0.94637 3.18191 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                x2        
     2.1902 1.0766  4.5916
  x2 1.0766 1.3159  5.0108
     4.5916 5.0108 19.3720
  hence, volume  =  4.0512 
n =  6 
`ellipsoid' in 2 dimensions:
 center = ( 3.00571 0.16772 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                x2
     4.6671 1.3033
  x2 1.3033 1.1810
  hence, area  =  12.269 
`ellipsoid' in 3 dimensions:
 center = ( 3.001953 0.190548 0.044757 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                 x2        
     3.4987 0.97829  4.3395
  x2 0.9783 0.88916  3.2353
     4.3395 3.23533 12.5688
  hence, volume  =  10.217 
n =  7 
`ellipsoid' in 2 dimensions:
 center = (  4.59021 -0.55166 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                  x2
      6.4748 -1.3814
  x2 -1.3814  1.7607
  hence, area  =  19.358 
`ellipsoid' in 3 dimensions:
 center = (  4.37935 -0.66414 -2.63999 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                    x2        
      4.95445 -0.85007 -4.6083
  x2 -0.85007  1.67731  7.3273
     -4.60831  7.32727 32.4084
  hence, volume  =  12.243 
n =  8 
`ellipsoid' in 2 dimensions:
 center = ( 3.87469 0.44376 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                  x2
     8.97764 0.30756
  x2 0.30756 1.04610
  hence, area  =  19.158 
`ellipsoid' in 3 dimensions:
 center = ( 3.99713 0.17476 0.49242 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                   x2         
      6.49056 0.11103 -0.16472
  x2  0.11103 1.01424  3.51177
     -0.16472 3.51177 13.02780
  hence, volume  =  21.901 
n =  9 
`ellipsoid' in 2 dimensions:
 center = ( 4.13381 0.60782 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                  x2
     11.8007 -1.5020
  x2 -1.5020  0.9070
  hence, area  =  18.262 
`ellipsoid' in 3 dimensions:
 center = ( 4.11233 0.71671 2.86123 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                    x2         
      8.42976 -0.78760 -0.48972
  x2 -0.78760  0.66669  2.64345
     -0.48972  2.64345 13.50370
  hence, volume  =  30.523 
n =  10 
`ellipsoid' in 2 dimensions:
 center = (  5.66597 -0.52336 ); squared ave.radius d^2 =  2 
 and shape matrix =
    
                    x2
     11.48653 -0.12406
  x2 -0.12406  1.97649
  hence, area  =  29.928 
`ellipsoid' in 3 dimensions:
 center = (  5.47310 -0.47315 -1.93572 ); squared ave.radius d^2 =  3 
 and shape matrix =
    
                    x2         
     10.53239 -0.26427 -0.90512
  x2 -0.26427  1.27555  4.94314
     -0.90512  4.94314 20.07397
  hence, volume  =  32.984 
> 
> x <- rt(100, df = 4)
> y <- 100 + 5 * x + rnorm(100)
> ellipsoidhull(cbind(x,y))
`ellipsoid' in 2 dimensions:
 center = ( -0.60656 96.60133 ); squared ave.radius d^2 =  2 
 and shape matrix =
   
         x       y
  x 12.882  62.655
  y 62.655 308.024
  hence, area  =  40.928 
> z <- 10  - 8 * x + y + rnorm(100)
> ellipsoidhull(cbind(x,y,z))
`ellipsoid' in 3 dimensions:
 center = (  -0.43389  97.53316 110.78868 ); squared ave.radius d^2 =  3 
 and shape matrix =
   
           x        y        z
  x   8.0188   38.733  -25.830
  y  38.7326  189.534 -122.846
  z -25.8302 -122.846   86.525
  hence, volume  =  56.295 
> 
